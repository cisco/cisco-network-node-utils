# vni
---
all_vnis:
  multiple:
  /N7K/:
    config_get: 'show vni'
    config_get_token: '/^(\d+)\s/'
  else:
    config_get: 'show running vlan'
    config_get_token: '/vn-segment (\d+)/'

bridge_domain:
  config_get: 'show vni'
  config_get_token: [ '/^%d\s+\S+\s+(\d+)/' ]
  config_set: ['bridge-domain <domain>', '<state> member vni <vni>', 'end']
  default_value: ~

bridge_domain_activate:
  config_set: ['<state> system bridge-domain add <domain>', 'end']

create:
  config_set: ['vni <vni>' , 'end']

destroy:
  /N7K/:
    config_set: 'no vni <vni>'
  /N9K/:
    config_set: ['vlan <vlan>', 'no vn-segment <vni> ; end']

encap_dot1q:
  config_set: ["encapsulation profile vni %s", "%s dot1q %s vni %s", "end"]
  default_value: ~

feature:
  config_get: 'show running | i ^feature'
  /N7K/:
    config_get_token: '/^feature vni$/'
    config_set: 'feature vni'
  /N9K/: 
    config_get_token: '/^feature vn-segment-vlan-based$/'
    config_set: 'feature vn-segment-vlan-based'

feature_nv_overlay:
  config_get: 'show running | i ^feature'
  config_get_token: '/^feature nv overlay$/'
  config_set: 'feature nv overlay'

mapped_vlan:
  /N9K/:
    config_get: 'show running vlan'
    config_get_token: ['/^vlan <vlan>$/', '/^vn-segment (\d+)$/']
    config_set: ['vlan <vlan>', '<state> vn-segment <vni> ; end']
    default_value: ''

shutdown:
  /N7K/:
    kind: boolean
    config_get: 'show vni'
    config_get_token: '/^<vni> +Down/'
    config_set: ['vni <vni>', '<state> shutdown', 'end']
    default_value: false
